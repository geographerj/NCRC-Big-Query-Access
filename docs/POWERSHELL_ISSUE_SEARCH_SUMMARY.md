# PowerShell Issue - Searchable Summary for Online Research

## Problem Description

**IDE**: Cursor (based on VS Code)
**OS**: Windows 10/11
**Shell**: PowerShell (default terminal)
**Issue**: All terminal commands fail with PowerShell parsing errors, even simple commands like `python --version`

## Exact Error Message

```
At C:\Users\edite\AppData\Local\Temp\ps-script-{guid}.ps1:34 char:134
+ ... coding]::UTF8.GetString([System.Convert]::FromBase64String(''{1}''))) ...
+                                                                         ~
Missing ')' in method call.
The string is missing the terminator: '.
+ CategoryInfo: ParserError: (:) [], ParentContainsErrorRecordException
+ FullyQualifiedErrorId: MissingEndParenthesisInMethodCall
```

## Key Technical Details

### 1. Error Location
- **File**: Temporary PowerShell script in `%LOCALAPPDATA%\Temp\ps-script-*.ps1`
- **Line**: Around line 34, character 134
- **Pattern**: Base64 decoding command with malformed quote escaping

### 2. Root Cause Hypothesis
Cursor IDE appears to:
1. Encode commands as Base64 strings
2. Generate a PowerShell wrapper script that decodes them
3. The wrapper uses: `[System.Convert]::FromBase64String(''{1}'')`
4. **Problem**: Quote escaping fails when project path contains special characters

### 3. Project Path Context
**Current path contains**:
- Spaces: `OneDrive - Nat'l Community Reinvestment Coaltn\Desktop\DREAM Analysis`
- **Apostrophe**: `Nat'l` (this is likely the culprit)
- Special character: `'` in the directory name

### 4. Error Pattern
The error suggests the wrapper script is generating something like:
```powershell
$decoded = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(''{base64_encoded_command}''))
```

Where the nested quotes `''{1}''` are causing parsing failures.

## Search Terms for Online Research

### Primary Searches
1. **"Cursor IDE" "PowerShell" "Missing terminator" "Base64"**
2. **"VS Code" PowerShell wrapper "FromBase64String" quote escaping**
3. **"Integrated terminal" PowerShell "string missing terminator" apostrophe path**
4. **"Cursor IDE" terminal "Missing ')' in method call" PowerShell**

### Secondary Searches
5. **PowerShell Base64 decode nested quotes escaping path with apostrophe**
6. **"Cursor IDE" PowerShell command wrapper encoding issues**
7. **IDE terminal wrapper Base64 command encoding special characters**
8. **PowerShell script path apostrophe Base64 decode error**

### GitHub/Issue Tracker Searches
9. **site:github.com cursor-ai OR "getcursor" PowerShell terminal error**
10. **site:github.com "getcursor" PowerShell "Base64" wrapper**
11. **site:github.com vscode PowerShell integrated terminal Base64 encode**

### Reddit/Forum Searches
12. **site:reddit.com "Cursor IDE" PowerShell terminal not working**
13. **site:stackoverflow.com PowerShell Base64 decode nested quotes error**

## What to Include in Bug Reports

### Environment
- **IDE**: Cursor (version: [check Help → About])
- **OS**: Windows 10/11 (version: [run `winver`])
- **Terminal**: PowerShell (default profile)
- **Python**: [version from external terminal]

### Project Path
```
C:\Users\edite\OneDrive - Nat'l Community Reinvestment Coaltn\Desktop\DREAM Analysis
```
**Key issue**: Path contains apostrophe (`'`) in directory name

### Reproduction Steps
1. Open Cursor IDE
2. Open project in path with apostrophe: `...\Nat'l Community...`
3. Try ANY terminal command: `python --version`
4. Observe PowerShell parsing error

### Error Details
- **File**: Temp PowerShell script generated by Cursor
- **Error Type**: ParserError - String terminator issue
- **Context**: Base64 decoding wrapper command
- **Scope**: Affects ALL commands, not command-specific

### Workarounds That Work
1. ✅ Using external terminal (Command Prompt/PowerShell outside Cursor)
2. ✅ Changing default terminal profile to Command Prompt in Cursor settings
3. ✅ Moving project to path without special characters (untested)
4. ✅ Using batch files instead of direct Python commands

### Workarounds That Don't Work
- ❌ Using `cmd /c` prefix
- ❌ Escaping quotes manually
- ❌ Using relative vs absolute paths
- ❌ Restarting Cursor or computer

## Likely Related Issues

### VS Code (Base Platform)
Cursor is based on VS Code. Search for:
- **VS Code PowerShell integrated terminal Base64 encoding**
- **VS Code PowerShell wrapper quote escaping issues**

### Known VS Code PowerShell Issues
1. **Path escaping in PowerShell integrated terminal**
2. **Special characters in paths causing command failures**
3. **PowerShell profile conflicts with IDE terminal**

## Technical Analysis

### The Wrapper Pattern
Cursor likely generates PowerShell commands like:
```powershell
# Pseudocode of what Cursor might be doing
$encodedCmd = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($originalCommand))
$wrapper = "powershell -Command [Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('$encodedCmd'))"
```

### The Bug
When the project path contains an apostrophe (`'`), the Base64 string or the wrapper script generation likely creates malformed PowerShell syntax:
- Expected: `FromBase64String('base64string')`
- Actual (broken): `FromBase64String(''{1}'')` or similar

### Why It Fails
PowerShell's quote parsing gets confused by:
1. Nested single quotes
2. Apostrophes in paths that get encoded/decoded
3. Base64 strings that may contain quote-like characters

## Potential Fixes (User-Level)

1. **Change default terminal** in Cursor settings to Command Prompt (not PowerShell)
2. **Rename project folder** to remove apostrophe: `Nat'l` → `National`
3. **Move project** to simpler path: `C:\Projects\DREAM Analysis`
4. **Use Git Bash** as default terminal (if installed)

## Questions for Online Communities

1. "Has anyone else experienced Cursor IDE PowerShell terminal failing with Base64 decoding errors?"
2. "Cursor IDE PowerShell wrapper fails with project paths containing apostrophes - any fixes?"
3. "Why does Cursor's terminal wrapper generate malformed PowerShell scripts for Base64 decoding?"
4. "Is there a way to disable Cursor's command encoding wrapper for terminal execution?"

## Related Documentation Files

- `docs/archive/POWERSHELL_ISSUE_STATUS.md` - Original investigation
- `docs/archive/POWERSHELL_WRAPPER_INVESTIGATION.md` - Technical details
- `docs/archive/TERMINAL_ISSUE_SUMMARY.md` - Timeline and attempts

## Next Steps

1. **Search using terms above** on:
   - Cursor GitHub repository
   - VS Code GitHub repository (related issues)
   - Stack Overflow
   - Reddit r/cursor
   - Cursor Discord/Community

2. **If no results found**, consider:
   - Reporting bug to Cursor support/GitHub
   - Testing with simplified path (move project temporarily)
   - Using workarounds (Command Prompt, external terminal)

3. **Document findings** in this file for future reference

